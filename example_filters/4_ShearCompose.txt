// copy & paste into playground for testing

const WIDTH = getVideoWidth();
const HEIGHT = getVideoHeight();

const x_shear = math_floor(WIDTH/3);
const y_shear = math_floor(HEIGHT/4);

function horiz_shear(src, dest){
    for (var x=0; x<WIDTH; x = x+1){
        for (var y=0; y<HEIGHT; y = y+1){

            const x_shift = math_floor(y / HEIGHT * x_shear); // similar triangles 

            var u = x < x_shift 
                        ? WIDTH - x_shift + x 
                        : x - x_shift;
            copy_pixel(
                src[u][y], 
                dest[x][y]
                );
        }
    }
}
function vert_shear(src, dest){
    for (var x=0; x<WIDTH; x = x+1){
        for (var y=0; y<HEIGHT; y = y+1){

            const y_shift = math_floor(x / WIDTH * y_shear); // similar triangles 

            var v = y < y_shift 
                        ? HEIGHT - y_shift + y
                        : y - y_shift;
            copy_pixel(
                src[x][v], 
                dest[x][y]
                );
        }
    }
}

//apply_filter(vert_shear);
//apply_filter(horiz_shear);
apply_filter(compose_filter(vert_shear,horiz_shear));