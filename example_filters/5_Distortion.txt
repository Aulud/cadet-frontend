// copy & paste into playground for testing

const WIDTH = getVideoWidth();
const HEIGHT = getVideoHeight();

function distort(src, dest){
    for (var i=0; i<WIDTH; i = i+1){
        for (var j=0; j<HEIGHT; j = j+1){
            var offset_x = math_floor(WIDTH/16 *  math_sin(i / WIDTH * 2 * math_PI));
            var offset_y = math_floor(HEIGHT/16 * math_sin(j / HEIGHT * 2 * math_PI));
            var u = offset_x + i; //swap offset_x, offset_y for cool different effect
            var v = offset_y + j;
            if (0 <= u && u < WIDTH && 0 <= v && v < HEIGHT){
                copy_pixel(src[u][v], dest[i][j]);
            } else {
                set_rgb(dest[i][j], 0,0,0);
            }
        }
    }
}
apply_filter(distort);

